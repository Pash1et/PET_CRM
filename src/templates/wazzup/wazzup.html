{% extends "base.html" %}

{% block content %}

<div class="header-row">
    <a href="/ui/" class="crm-back-btn-simple">← Назад</a>
    <h1 class="page-title-inline">Wazzup</h1>
</div>

<div class="iframe-wrapper">
    <div class="spinner" id="wazzup-spinner">
        <div class="spinner-circle"></div>
        <p>Загрузка Wazzup...</p>
    </div>

    <iframe
        id="wazzup-iframe"
        src="{{ wazzup_url }}"
        allow="microphone *; clipboard-write *"
        frameborder="0"
        loading="lazy"
        onload="hideSpinner()"
    ></iframe>
</div>

<style>
    body {
        margin: 0;
        padding: 0;
        height: 100vh;
        overflow: hidden;
    }

    .container {
        height: 100vh;
        display: flex;
        flex-direction: column;
        overflow: hidden;
    }

    .header-row {
        display: flex;
        align-items: center;
        gap: 16px;
        padding: 20px 0 16px 0;
        background: #f6f6f6;
        z-index: 2;
    }

    .crm-back-btn-simple {
        display: inline-flex;
        align-items: center;
        gap: 8px;
        padding: 8px 14px;
        background: #ffffff;
        color: #2c3e50;
        text-decoration: none;
        border: 1px solid #e0e0e0;
        border-radius: 8px;
        font-size: 14px;
        font-weight: 500;
        box-shadow: 0 2px 4px rgba(0,0,0,0.05);
        transition: background 0.15s ease, box-shadow 0.15s ease;
        flex-shrink: 0;
    }

    .crm-back-btn-simple:hover {
        background: #f7f9fc;
        box-shadow: 0 3px 8px rgba(0,0,0,0.08);
    }

    .page-title-inline {
        margin: 0;
        font-size: 26px;
        color: #2c3e50;
        font-weight: 600;
        white-space: nowrap;
        flex: 1;
    }

    .iframe-wrapper {
        flex: 1;
        width: 100%;
        min-height: 0;
        overflow: hidden;
        display: flex;
        justify-content: center;
        align-items: flex-start;
        background: #f8f9fa;
        border-radius: 12px;
        box-shadow: inset 0 0 8px rgba(0,0,0,0.05);
    }

    .spinner {
        position: absolute;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
        background: #f8f9fa;
        display: flex;
        flex-direction: column;
        justify-content: center;
        align-items: center;
        z-index: 10;
        border-radius: 12px;
    }

    .spinner-circle {
        width: 50px;
        height: 50px;
        border: 4px solid #e0e0e0;
        border-top: 4px solid #4CAF50;
        border-radius: 50%;
        animation: spin 1s linear infinite;
    }

    .spinner p {
        margin-top: 16px;
        font-size: 14px;
        color: #666;
        font-weight: 500;
    }

    @keyframes spin {
        0% { transform: rotate(0deg); }
        100% { transform: rotate(360deg); }
    }

    #wazzup-iframe {
        width: 100%;
        max-width: 1400px;
        height: 100%;
        border: none;
        border-radius: 12px;
        box-shadow: 0 4px 12px rgba(0,0,0,0.1);
        opacity: 0;
        transition: opacity 0.3s ease;
    }

    #wazzup-iframe.loaded {
        opacity: 1;
    }
</style>

<script>
    function hideSpinner() {
        const spinner = document.getElementById('wazzup-spinner');
        const iframe = document.getElementById('wazzup-iframe');

        iframe.classList.add('loaded');
        spinner.style.opacity = '0';
        setTimeout(() => {
            if (spinner && spinner.parentNode) {
                spinner.remove();
            }
        }, 300);
    }

    document.body.style.margin = '0';
    document.body.style.padding = '0';
    document.body.style.overflow = 'hidden';
</script>

{% endblock %}
